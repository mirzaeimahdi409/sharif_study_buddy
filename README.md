# ุฏุณุชุงุฑ ููุดููุฏ ุฏุงูุดุฌู ุฏุงูุดฺฏุงู ุตูุนุช ุดุฑู

ฺฉ ุจุงุช ุชูฺฏุฑุงู ููุดููุฏ ุจุฑุง ฺฉูฺฉ ุจู ุฏุงูุดุฌูุงู ุฏุงูุดฺฏุงู ุตูุนุช ุดุฑู ฺฉู ุงุฒ ุชฺฉููููฺโูุง ูพุดุฑูุชู AI ูุงููุฏ LangGraphุ LangChainุ RAG (Retrieval Augmented Generation) ู OpenRouter ุงุณุชูุงุฏู ูโฺฉูุฏ.

## ูฺฺฏโูุง

- ๐ค **ุจุงุช ุชูฺฏุฑุงู**: ุฑุงุจุท ฺฉุงุฑุจุฑ ุณุงุฏู ู ุฏูุณุชุงูู ุจุฑุง ุฏุงูุดุฌูุงู
- ๐ง **ููุด ูุตููุน ูพุดุฑูุชู**: ุงุณุชูุงุฏู ุงุฒ LangGraph ู LangChain ุจุฑุง ูพุฑุฏุงุฒุด ููุดููุฏ
- ๐ **RAG (Retrieval Augmented Generation)**: ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุฒ ุงุณูุงุฏ ุฏุงูุดฺฏุงู
- ๐ **ุฌุณุชุฌู ููุดููุฏ**: ุงุณุชูุงุฏู ุงุฒ ูฺฉุฑูุณุฑูุณ RAG ุจุฑุง ุงูุชู ุงุทูุงุนุงุช ูุฑุชุจุท
- ๐ฅ **ูุฏุฑุช ุฏุณุชุฑุณ**: ุชูฺฉฺฉ ุฏุณุชุฑุณ ุงุฏูู ู ฺฉุงุฑุจุฑ ูุนููู
- โก **ูพุฑุฏุงุฒุด ูพุณโุฒููู**: ุงุณุชูุงุฏู ุงุฒ Celery ู Redis ุจุฑุง ุนููุงุช ุณูฺฏู
- ๐ **ูพูู ุงุฏูู**: ูุฏุฑุช ูุญุชูุง ู ุงุณูุงุฏ ุงุฒ ุทุฑู Django Admin

## ูุนูุงุฑ

ูพุฑูฺู ุงุฒ ูุนูุงุฑ ุชูุฒ ู ูุงฺููุงุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ:

```
sharif_assistant/
โโโ core/                    # ุงูพูฺฉุดู ุงุตู
โ   โโโ models.py           # ูุฏูโูุง ุฏุงุฏู (UserProfile, ChatSession, ChatMessage, KnowledgeDocument)
โ   โโโ admin.py            # ูพูู ุงุฏูู Django
โ   โโโ services/           # ุณุฑูุณโูุง AI
โ   โ   โโโ langgraph_pipeline.py  # Pipeline ุงุตู ุจุง LangGraph
โ   โ   โโโ openrouter.py          # ฺฉูุงูุช OpenRouter
โ   โ   โโโ rag_client.py          # ฺฉูุงูุช RAG ูฺฉุฑูุณุฑูุณ
โ   โโโ tasks.py            # ุชุณฺฉโูุง Celery ุจุฑุง ูพุฑุฏุงุฒุด ูพุณโุฒููู
โโโ bot/                    # ุงูพูฺฉุดู ุจุงุช ุชูฺฏุฑุงู
โ   โโโ management/commands/
โ       โโโ start_bot.py    # ฺฉุงููุฏ Django ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุจุงุช
โโโ sharif_assistant/        # ุชูุธูุงุช ูพุฑูฺู
    โโโ settings.py         # ุชูุธูุงุช Django
    โโโ celery.py           # ูพฺฉุฑุจูุฏ Celery
```

## ูพุดโูุงุฒูุง

- Python 3.9+
- PostgreSQL
- Redis
- Telegram Bot Token
- OpenRouter API Key
- ุฏุณุชุฑุณ ุจู ูฺฉุฑูุณุฑูุณ RAG

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### 1. ฺฉููู ฺฉุฑุฏู ูพุฑูฺู

```bash
git clone <repository-url>
cd shrif-bot
```

### 2. ุงุฌุงุฏ ูุญุท ูุฌุงุฒ

```bash
python -m venv venv
source venv/bin/activate  # ุฏุฑ Windows: venv\Scripts\activate
```

### 3. ูุตุจ ูุงุจุณุชฺฏโูุง

```bash
pip install -r requirements.txt
```

### 4. ุชูุธู ูุชุบุฑูุง ูุญุท

ูุงู `.env.example` ุฑุง ฺฉูพ ฺฉุฑุฏู ู ููุงุฏุฑ ุฑุง ุชูุธู ฺฉูุฏ:

```bash
cp .env.example .env
```

ุณูพุณ ูุงู `.env` ุฑุง ูุฑุงุด ฺฉูุฏ ู ููุงุฏุฑ ุฒุฑ ุฑุง ุชูุธู ฺฉูุฏ:

- `SECRET_KEY`: ฺฉูุฏ ูุฎู Django
- `TELEGRAM_BOT_TOKEN`: ุชูฺฉู ุจุงุช ุชูฺฏุฑุงู (ุงุฒ @BotFather ุฏุฑุงูุช ฺฉูุฏ)
- `OPENROUTER_API_KEY`: ฺฉูุฏ API OpenRouter
- `RAG_API_URL`: ุขุฏุฑุณ ูฺฉุฑูุณุฑูุณ RAG (ูพุดโูุฑุถ: `http://45.67.139.109:8033/api`)
- ุชูุธูุงุช PostgreSQL ู Redis

### 5. ุชูุธู ูพุงฺฏุงู ุฏุงุฏู

```bash
python manage.py migrate
```

### 6. ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฏูู

```bash
python manage.py createsuperuser
```

### 7. ุฑุงูโุงูุฏุงุฒ Redis

```bash
redis-server
```

ุง ุงฺฏุฑ ุงุฒ Docker ุงุณุชูุงุฏู ูโฺฉูุฏ:

```bash
docker run -d -p 6379:6379 redis:latest
```

### 8. ุฑุงูโุงูุฏุงุฒ Celery Worker (ุงุฎุชุงุฑ)

ุจุฑุง ูพุฑุฏุงุฒุด ุชุณฺฉโูุง ูพุณโุฒููู:

```bash
celery -A sharif_assistant worker --loglevel=info
```

### 9. ุฑุงูโุงูุฏุงุฒ ุจุงุช ุชูฺฏุฑุงู

```bash
python manage.py start_bot
```

## ุณุทูุญ ุฏุณุชุฑุณ

### ฺฉุงุฑุจุฑุงู ูุนููู

- **ุฏุณุชุฑุณ**: ููุท ุงุฒ ุทุฑู ุจุงุช ุชูฺฏุฑุงู
- **ุนููฺฉุฑุฏ**:
  - ฺุช ุจุง ุจุงุช ู ุฏุฑุงูุช ูพุงุณุฎโูุง ูุจุชู ุจุฑ RAG
  - ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงุช `/start`, `/help`, `/reset`
- **ุงุฌุงุฏ ุฎูุฏฺฉุงุฑ**: ฺฉุงุฑุจุฑุงู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ููฺฏุงู ุงููู ุงุณุชูุงุฏู ุงุฒ ุจุงุช ุงุฌุงุฏ ูโุดููุฏ
- **ูุญุฏูุฏุช**: ุงู ฺฉุงุฑุจุฑุงู ุจู ูพูู ุงุฏูู Django ุฏุณุชุฑุณ ูุฏุงุฑูุฏ

### ุงุฏููโูุง

- **ุฏุณุชุฑุณ**: ุงุฒ ุทุฑู ูพูู ุงุฏูู Django (`/admin`)
- **ุนููฺฉุฑุฏ**:
  - ูุฏุฑุช ุงุณูุงุฏ ุฏุงูุด (`KnowledgeDocument`)
  - ุงุฑุณุงู ุงุณูุงุฏ ุจู RAG
  - ุจุงุฒูพุฑุฏุงุฒุด ุงุณูุงุฏ
  - ูุดุงูุฏู ฺฉุงุฑุจุฑุงูุ ุณุดูโูุง ู ูพุงูโูุง
- **ุงุฌุงุฏ**: ุงุฒ ุทุฑู ฺฉุงููุฏ `python manage.py createsuperuser`
- **ูฺฺฏโูุง**:
  - ุนููุงุช ุณูฺฏู (ุงุฑุณุงู/ุจุงุฒูพุฑุฏุงุฒุด) ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ูพุณโุฒููู ุจุง Celery ุงูุฌุงู ูโุดูุฏ

## ุงุณุชูุงุฏู

### ุจุฑุง ฺฉุงุฑุจุฑุงู

1. ุจุงุช ุฑุง ุฏุฑ ุชูฺฏุฑุงู ูพุฏุง ฺฉูุฏ
2. ุฏุณุชูุฑ `/start` ุฑุง ุงุฑุณุงู ฺฉูุฏ
3. ุณูุงู ุฎูุฏ ุฑุง ุจูพุฑุณุฏ
4. ูพุงุณุฎ ูุจุชู ุจุฑ ุงุณูุงุฏ ุฏุงูุดฺฏุงู ุฏุฑุงูุช ฺฉูุฏ

### ุจุฑุง ุงุฏููโูุง

1. ุจู `/admin` ุจุฑูุฏ ู ูุงุฑุฏ ุดูุฏ
2. ุฏุฑ ุจุฎุด "Knowledge Documents":
   - ุงุณูุงุฏ ุฌุฏุฏ ุงุถุงูู ฺฉูุฏ
   - ุงุณูุงุฏ ุฑุง ุงูุชุฎุงุจ ฺฉุฑุฏู ู ุงุฒ ุงฺฉุดู "๐ค ุงุฑุณุงู ุงุณูุงุฏ ุงูุชุฎุงุจโุดุฏู ุจู RAG" ุงุณุชูุงุฏู ฺฉูุฏ
   - ุจุฑุง ุจุงุฒูพุฑุฏุงุฒุด ุงุฒ ุงฺฉุดู "๐ ุจุงุฒูพุฑุฏุงุฒุด ุงุณูุงุฏ ุฏุฑ RAG" ุงุณุชูุงุฏู ฺฉูุฏ

## ุชูุธูุงุช ูพุดุฑูุชู

### ูุชุบุฑูุง ูุญุท

| ูุชุบุฑ              | ุชูุถุญ                  | ูพุดโูุฑุถ           |
| ------------------ | ---------------------- | ----------------- |
| `CHAT_MAX_HISTORY` | ุชุนุฏุงุฏ ูพุงูโูุง ุชุงุฑุฎฺู | 8                 |
| `RAG_TOP_K`        | ุชุนุฏุงุฏ ูุชุงุฌ RAG        | 5                 |
| `LLM_TEMPERATURE`  | ุฏูุง ูุฏู LLM           | 0.2               |
| `OPENROUTER_MODEL` | ูุฏู OpenRouter         | `openrouter/auto` |

### ูพฺฉุฑุจูุฏ RAG

ูฺฉุฑูุณุฑูุณ RAG ุจุงุฏ ุฏุฑ ุขุฏุฑุณ ูุดุฎุต ุดุฏู ุฏุฑ `RAG_API_URL` ุฏุฑ ุฏุณุชุฑุณ ุจุงุดุฏ. API ุจุงุฏ ุงุฒ endpoints ุฒุฑ ูพุดุชุจุงู ฺฉูุฏ:

- `POST /knowledge/search/` - ุฌุณุชุฌู ุงุณูุงุฏ
- `POST /knowledge/documents/` - ุงูุฒูุฏู ุณูุฏ ูุชู
- `POST /knowledge/documents/ingest-url/` - ุงูุฒูุฏู ุณูุฏ ุงุฒ URL
- `POST /knowledge/documents/{id}/reprocess/` - ุจุงุฒูพุฑุฏุงุฒุด ุณูุฏ

## ุชูุณุนู

### ุณุงุฎุชุงุฑ ฺฉุฏ

- **Services**: ููุทู ุงุตู AI ู RAG ุฏุฑ `core/services/`
- **Models**: ูุฏูโูุง ุฏุงุฏู ุฏุฑ `core/models.py`
- **Admin**: ูพฺฉุฑุจูุฏ ุงุฏูู ุฏุฑ `core/admin.py`
- **Tasks**: ุชุณฺฉโูุง Celery ุฏุฑ `core/tasks.py`
- **Bot**: ููุทู ุจุงุช ุชูฺฏุฑุงู ุฏุฑ `bot/management/commands/start_bot.py`

### ุงูุฒูุฏู ูฺุฑ ุฌุฏุฏ

1. ูุฏู ุฌุฏุฏ ุฑุง ุฏุฑ `core/models.py` ุชุนุฑู ฺฉูุฏ
2. ูุงฺฏุฑุดู ุงุฌุงุฏ ฺฉูุฏ: `python manage.py makemigrations`
3. ูุงฺฏุฑุดู ุฑุง ุงุนูุงู ฺฉูุฏ: `python manage.py migrate`
4. ุฏุฑ ุตูุฑุช ูุงุฒุ ุชุณฺฉ Celery ุฏุฑ `core/tasks.py` ุงุถุงูู ฺฉูุฏ

## ุนุจโุงุจ

### ุจุงุช ฺฉุงุฑ ููโฺฉูุฏ

- ุจุฑุฑุณ ฺฉูุฏ ฺฉู `TELEGRAM_BOT_TOKEN` ุฏุฑุณุช ุชูุธู ุดุฏู ุจุงุดุฏ
- ูุงฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ุจุงุช ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช

### ุฎุทุง ุฏุฑ RAG

- ุจุฑุฑุณ ฺฉูุฏ ฺฉู `RAG_API_URL` ุฏุฑุณุช ุจุงุดุฏ
- ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ูฺฉุฑูุณุฑูุณ RAG ุฏุฑ ุฏุณุชุฑุณ ุงุณุช
- ูุงฺฏโูุง Celery worker ุฑุง ุจุฑุฑุณ ฺฉูุฏ

### ุฎุทุง ุฏุฑ LLM

- ุจุฑุฑุณ ฺฉูุฏ ฺฉู `OPENROUTER_API_KEY` ุฏุฑุณุช ุจุงุดุฏ
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุงุนุชุจุงุฑ ุญุณุงุจ OpenRouter ฺฉุงู ุงุณุช
- ูุงฺฏโูุง ุฑุง ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑ ุจุฑุฑุณ ฺฉูุฏ

## ูุฌูุฒ

ุงู ูพุฑูฺู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุฏุงูุดฺฏุงู ุตูุนุช ุดุฑู ุชูุณุนู ุงูุชู ุงุณุช.

## ูพุดุชุจุงู

ุจุฑุง ุณูุงูุงุช ู ูุดฺฉูุงุชุ ูุทูุงู issue ุงุฌุงุฏ ฺฉูุฏ ุง ุจุง ุชู ุชูุณุนู ุชูุงุณ ุจฺฏุฑุฏ.




